(()=>{"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,s(i.key),i)}}function r(e,r,s){return r&&t(e.prototype,r),s&&t(e,s),Object.defineProperty(e,"prototype",{writable:!1}),e}function s(t){var r=function(t){if("object"!=e(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var s=r.call(t,"string");if("object"!=e(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(r)?r:r+""}const i=r((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),jQuery("#pp-options-module-help .pp-docs-hide").hide(),jQuery("#pp-options-module-help .pp-docs-title").on("click",(function(){jQuery(this).toggleClass("pp-toggle"),jQuery(this).next().slideToggle("fast")})),jQuery("#pp-options-module-toolkit .pp-toolkit-content").hide(),jQuery("#pp-options-module-toolkit .pp-toolkit-title").on("click",(function(){jQuery(this).toggleClass("pp-toggle"),jQuery(this).next().slideToggle("fast")})),jQuery(".pp-hidden-settings").hide(),jQuery(".pp-hidden-settings-title").on("click",(function(){jQuery(this).toggleClass("pp-toggle"),jQuery(this).next().slideToggle("fast")}))}));function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function n(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,a(s.key),s)}}function a(e){var t=function(e){if("object"!=o(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==o(t)?t:t+""}const p=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.data=window.ppjsAdminOpt||{},this.adminPage=jQuery("#pp-options-page"),this.index=jQuery(".select-pp-feed-index").first(),this.refresh=jQuery(".pp-feed-refresh"),this.reset=jQuery(".pp-feed-reset"),this.feedback=jQuery(".pp-toolkit-feedback").first(),this.newFeedback=jQuery("#pp-action-feedback"),this.managePodcastList=this.adminPage.find(".pp-podcasts-list"),this.events()},t=[{key:"events",value:function(){var e=this,t=this;this.refresh.on("click",function(){this.ajaxFeedEditor("refresh")}.bind(this)),this.reset.on("click",function(){this.ajaxFeedEditor("reset")}.bind(this)),jQuery(".pp-feed-del").on("click",(function(){t.index.val()?(jQuery(this).next(".pp-toolkit-del-confirm").slideDown("fast"),t.response()):t.response(t.data.messages.nourl,"pp-error")})),jQuery(".pp-feed-cancel").on("click",(function(){jQuery(this).parents(".pp-toolkit-del-confirm").hide()})),this.managePodcastList.on("click",".pp-podcast-refresh-btn",(function(t){var r=jQuery(t.currentTarget);e.feedRefreshDelete("refresh",r)})),this.managePodcastList.on("click",".pp-podcast-delete-btn",(function(t){var r=jQuery(t.currentTarget);e.feedRefreshDelete("reset",r)})),this.newFeedback.on("click",".pp-error-close",(function(t){e.newFeedback.removeClass("pp-error")}))}},{key:"ajaxFeedEditor",value:function(e){var t=this,r=this.getAjaxConfig(e);this.response(this.data.messages.running,"pp-running"),r?jQuery.ajax({url:this.data.ajaxurl,data:r,type:"POST",timeout:6e4,success:function(e){var r=JSON.parse(e);jQuery.isEmptyObject(r)||(void 0!==r.error?t.response(r.error,"pp-error"):void 0!==r.message&&t.response(r.message,"pp-success"))},error:function(e,r,s){t.response(s,"pp-error")}}):this.response(this.data.messages.nourl,"pp-error")}},{key:"feedRefreshDelete",value:function(e,t){var r=this,s=t.closest(".pp-podcast-list-item"),i=s.data("podcast"),o={action:"pp_feed_editor",security:this.data.security,atype:e,feedUrl:i};t.addClass("pp-wip"),this.managePodcastList.find(".pp-toolkit-buttons").prop("disabled",!0),jQuery.ajax({url:this.data.ajaxurl,data:o,type:"POST",timeout:6e4,success:function(i){var o=JSON.parse(i);jQuery.isEmptyObject(o)||(void 0!==o.error?r.newResponse(o.error,"pp-error"):void 0!==o.message&&(r.newResponse(o.message,"pp-success"),"reset"==e&&s.fadeOut(200,(function(){jQuery(this).remove()}))),t.removeClass("pp-wip"),setTimeout((function(){r.managePodcastList.find(".pp-toolkit-buttons").prop("disabled",!1)}),1500))},error:function(e,s,i){r.newResponse(i,"pp-error"),t.removeClass("pp-wip"),r.managePodcastList.find(".pp-toolkit-buttons").prop("disabled",!1)}})}},{key:"getAjaxConfig",value:function(e){var t=this.index.val();return!!t&&{action:"pp_feed_editor",security:this.data.security,atype:e,feedUrl:t}}},{key:"response",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.feedback.removeClass("pp-error pp-success pp-running"),!1!==t&&(this.feedback.addClass(t),this.feedback.find(".pp-feedback").text(e))}},{key:"newResponse",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.newFeedback.removeClass("pp-error pp-success pp-running"),!1!==t&&(this.newFeedback.addClass(t),this.newFeedback.find(".pp-feedback").text(e)),setTimeout(function(){this.newFeedback.removeClass("pp-success pp-running")}.bind(this),1500)}}],t&&n(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function u(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,d(s.key),s)}}function d(e){var t=function(e){if("object"!=c(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=c(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==c(t)?t:t+""}const l=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.data=window.ppjsAdminOpt||{},this.adminPage=jQuery("#pp-options-page"),this.openSourceUrlBtn=this.adminPage.find(".pp-podcast-source-btn"),this.addSourceUrlBtn=this.adminPage.find(".pp-podcast-new-source-btn"),this.delSourceBtn=this.adminPage.find(".pp-podcast-delete-source-url"),this.newFeedback=jQuery("#pp-action-feedback"),this.events()},t=[{key:"events",value:function(){var e=this;this.openSourceUrlBtn.on("click",(function(e){jQuery(this).closest(".pp-podcast-info").find(".pp-podcast-source-container").slideToggle("fast")})),this.addSourceUrlBtn.on("click",(function(t){var r=jQuery(this),s=r.closest(".pp-podcast-source-container"),i=s.find(".pp-podcast-existing-source"),o=i.find(".pp-podcast-existing-source-url"),n=s.find(".pp-podcast-new-source"),a=n.find(".pp-podcast-new-source-url"),p=a.val();if(p){var c=n.closest(".pp-podcast-list-item").data("podcast"),u={action:"pp_migrate_podcast",security:e.data.security,podcast_id:c,source_url:p};a.attr("disabled",!0),r.attr("disabled",!0),jQuery.ajax({url:e.data.ajaxurl,data:u,type:"POST",timeout:6e4,success:function(t){var s=JSON.parse(t);jQuery.isEmptyObject(s)||(void 0!==s.error?e.newResponse(s.error,"pp-error"):void 0!==s.message&&(o.html(p),i.show(),a.val(""),e.newResponse(s.message,"pp-success"))),a.attr("disabled",!1),r.attr("disabled",!1)},error:function(t,s,i){a.attr("disabled",!1),r.attr("disabled",!1),e.newResponse(i,"pp-error")}})}else e.newResponse(e.data.messages.nosource,"pp-error")})),this.delSourceBtn.on("click",(function(t){t.preventDefault();var r=jQuery(this),s=r.closest(".pp-podcast-existing-source"),i=s.find(".pp-podcast-existing-source-url"),o={action:"pp_delete_source",podcast_id:r.closest(".pp-podcast-list-item").data("podcast"),security:e.data.security};r.attr("disabled",!0),jQuery.ajax({url:e.data.ajaxurl,data:o,type:"POST",timeout:6e4,success:function(t){var o=JSON.parse(t);jQuery.isEmptyObject(o)||(void 0!==o.error?e.newResponse(o.error,"pp-error"):void 0!==o.message&&(i.empty(),s.hide(),e.newResponse(o.message,"pp-success"))),r.attr("disabled",!1)},error:function(t,s,i){r.attr("disabled",!1),e.newResponse(i,"pp-error")}})}))}},{key:"newResponse",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.newFeedback.removeClass("pp-error pp-success pp-running"),!1!==t&&(this.newFeedback.addClass(t),this.newFeedback.find(".pp-feedback").text(e)),setTimeout(function(){this.newFeedback.removeClass("pp-success pp-running")}.bind(this),1500)}}],t&&u(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function h(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,y(s.key),s)}}function y(e){var t=function(e){if("object"!=f(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=f(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==f(t)?t:t+""}const v=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.data=window.ppjsAdminOpt||{},this.container=jQuery(".pp-toolkit-reviews"),this.feedBack=this.container.find(".pp-toolkit-feedback"),this.reviewData=!1,this.events()},t=[{key:"events",value:function(){var e=this,t=this.container.find(".select-pp-feed-index"),r=this.container.find(".podcast-reviews-refresh"),s=this.container.find(".podcast-reviews-delete");t.on("change",(function(){var t=jQuery(this),r=t.val();r&&e.ajaxRequest(t,r)})),r.on("click",(function(){var t=jQuery(this);e.refreshReviews(t)})),s.on("click",(function(){var t=jQuery(this);e.deleteReviews(t)}))}},{key:"ajaxRequest",value:function(e,t){var r=this,s=this.container.find(".pp-toolkit-review-form");this.response(this.data.messages.fetchId,"pp-running");var i={action:"pp_fetch_appleid",security:this.data.security,feedUrl:t||"",rFrom:t?"indexKey":""};this.updateCheckboxValues("",[]),s.removeClass("pp-review-success pp-review-error").hide(),jQuery.ajax({url:this.data.ajaxurl,data:i,type:"POST",timeout:6e4,success:function(e){var i=JSON.parse(e);if(!jQuery.isEmptyObject(i)){var o=i.status;if(void 0===i.status)s.addClass("pp-review-error").show(),r.response("",!1);else if("available"===o){var n=i.id,a=i.ccode,p=i.message;r.updateCheckboxValues(n,a),s.addClass("pp-review-success").show(),r.response(p,"pp-success")}else"error"===o?(s.addClass("pp-review-error").show(),r.response(i.message,"pp-error")):"fresh_fetch"===o&&r.fetchReviews(i.id,i.ccode,t)}},error:function(e,t,s){r.response(s,"pp-error")}})}},{key:"fetchReviews",value:function(e,t,r){var s=this,i=this.container.find(".pp-toolkit-review-form"),o=Object.keys(t);if(!o.length){this.response("",!1);var n=this.reviewData.id,a=this.reviewData.ccode,p=this.reviewData.message;return this.updateCheckboxValues(n,a),i.addClass("pp-review-success").show(),void this.response(p,"pp-success")}var c=o.shift(),u=t[c];delete t[c];var d={action:"pp_fetch_reviews",security:this.data.security,appleid:e,ccode:c,podcast:r};this.response(this.data.messages.fetchReviews+" "+u+"...","pp-running"),jQuery.ajax({url:this.data.ajaxurl,data:d,type:"POST",timeout:6e4,success:function(i){var o=JSON.parse(i);jQuery.isEmptyObject(o)||(void 0!==o.error?s.response(o.error,"pp-error"):void 0!==o.data&&(o.data&&(s.reviewData=o.data),s.fetchReviews(e,t,r)))},error:function(e,t,r){s.response(r,"pp-error")}})}},{key:"deleteReviews",value:function(e){var t=this,r=e.parents(".pp-toolkit-content"),s=r.find(".select-pp-feed-index").val(),i=r.find(".pp-toolkit-review-form"),o={action:"pp_delete_reviews",security:this.data.security,podcast:s};this.response(this.data.messages.deleteReviews+"...","pp-running"),jQuery.ajax({url:this.data.ajaxurl,data:o,type:"POST",timeout:6e4,success:function(e){var s=JSON.parse(e);jQuery.isEmptyObject(s)||(void 0!==s.error?t.response(s.error,"pp-error"):void 0!==s.message&&(t.response(s.message,"pp-success"),t.updateCheckboxValues("",[]),i.hide(),r.find(".select-pp-feed-index").val("")))},error:function(e,r,s){t.response(s,"pp-error"),t.updateCheckboxValues("",[]),i.hide()}})}},{key:"refreshReviews",value:function(e){var t=e.parents(".pp-toolkit-content"),r=t.find(".select-pp-feed-index").val(),s=t.find(".pp-apple-podcast-url-input").val(),i=t.find(".pp-multicheckbox-container .pp-select-country li input:checked"),o={};i.each((function(){var e=jQuery(this),t=e.val(),r=e.closest("label").find(".pp-label").text().trim();o[t]=r})),r||this.response("Please Select a Valid Podcast.","pp-error"),s||this.response("Please Enter a Valid Apple ID.","pp-error"),o.length||this.response("Please select at least one country.","pp-error"),console.log(s,o,r),this.fetchReviews(s,o,r)}},{key:"response",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t?(this.feedBack.removeClass("pp-error pp-success pp-running").addClass(t),this.feedBack.find(".pp-feedback").text(e)):this.feedBack.removeClass("pp-error pp-success pp-running")}},{key:"updateCheckboxValues",value:function(e,t){var r=this.container.find(".pp-multicheckbox-container .pp-select-country");this.container.find(".pp-apple-podcast-url-input").val(e),r.find('input[type="checkbox"]').prop("checked",!1),t.forEach((function(e){e=e.toUpperCase(),r.find('input[value="'.concat(e,'"]')).prop("checked",!0)})),r.find('input[type="checkbox"]:checked').closest("li").prependTo(r)}}],t&&h(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();new i,new p,new l,new v})();